<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <meta name="author" content="CozyCloud - https://cozy.io">
        <link rel="canonical" href="https://docs.cozy.io/cozy-stack/sharing/">
        <link rel="shortcut icon" href="../../img/favicon.png">
        
        <title>/sharings - Sharing - Cozy Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
            <link href="../../css/extra.css" rel="stylesheet">
            <link href="../../css/highlight_theme.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://docs.cozy.io/">Cozy Documentation</a>
            <a class="navbar-brand" href="https://docs.cozy.io/en">en</a>
            <a class="navbar-brand" href="https://docs.cozy.io/fr/index_fr">fr</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Use <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../use/">User guide</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Synchronize <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../sync/">Stay in sync</a>
</li>
                            
<li >
    <a href="../../sync/phone/">Synchronize your phone</a>
</li>
                            
<li >
    <a href="../../sync/desktop/">Synchronize your computer</a>
</li>
                            
<li >
    <a href="../../sync/linux/">Install on GNU/Linux</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../download/">Download</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Install <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../install/">Install Cozy on your own server</a>
</li>
                            
<li >
    <a href="../../install/debian/">Debian</a>
</li>
                            
<li >
    <a href="../../install/manual/">Manual installation</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Develop <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../dev/">Let's hack some code</a>
</li>
                            
<li >
    <a href="../../dev/connect-mobile-app-local-stack/">Connect a mobile app to your local stack</a>
</li>
                            
<li >
    <a href="../../dev/intro/">Architecture</a>
</li>
                            
<li >
    <a href="../../dev/app/">Create your first app</a>
</li>
                            
<li >
    <a href="../../dev/konnector/">Develop a connector</a>
</li>
                            
<li >
    <a href="../../dev/cordova/">Create a mobile app with cordova</a>
</li>
                            
<li >
    <a href="../../dev/sendmail/">How to send mail in development</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">References</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">cozy-client-js</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-client-js/intro/">Introduction</a>
</li>
            
<li >
    <a href="../../cozy-client-js/browser-sdk-transition/">Transition from cozy-browser-sdk</a>
</li>
            
<li >
    <a href="../../cozy-client-js/offline/">How to support offline</a>
</li>
            
<li >
    <a href="../../cozy-client-js/oauth/">OAuth guide</a>
</li>
            
<li >
    <a href="../../cozy-client-js/auth-api/">Authentication API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/data-api/">Data System API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/files-api/">Files API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/jobs-api/">Jobs API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/intents-api/">Intents API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/settings-api/">Settings API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/sharing-api/">Sharing API</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-konnector-libs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-konnector-libs/api/">API</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/cli/">CLI</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/dev/">Develop</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/errors/">Errors</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/operation-linking/">Operation linking</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/synchronization/">Synchronization</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-doctypes</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.accounts/">Accounts</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.photos.albums/">Albums</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.bank/">Banking doctypes</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.bills/">Bills</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.konnectors/">Connectors</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.contacts/">Contacts</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.files/">Files</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.notifications/">Notifications</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.payslips/">Payslips</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.remote.requests/">Remote requests</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.sessions.logins/">Session logins</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.triggers/">Triggers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-stack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../README/">README</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Architecture</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../architecture/">General overview</a>
</li>
            
<li >
    <a href="../security/">Security</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Usage</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../INSTALL/">Install the cozy-stack</a>
</li>
            
<li >
    <a href="../cli/cozy-stack/">Manpages of the command-line tool</a>
</li>
            
<li >
    <a href="../config/">Configuration file</a>
</li>
            
<li >
    <a href="../instance/">Managing Instances</a>
</li>
            
<li >
    <a href="../onboarding/">Onboarding</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">For developpers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../client-app-dev/">Develop a client-side app</a>
</li>
            
<li >
    <a href="../docker/">Running and building Docker images</a>
</li>
            
<li >
    <a href="../release/">Build a release</a>
</li>
            
<li >
    <a href="../CONTRIBUTING/">The contributing guide</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Services</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../auth/">/auth - Authentication & OAuth</a>
</li>
            
<li >
    <a href="../apps/">/apps - Applications Management</a>
</li>
            
<li >
    <a href="../registry/">Apps registry</a>
</li>
            
<li >
    <a href="../data-system/">/data - Data System</a>
</li>
            
<li >
    <a href="../mango/">Mango</a>
</li>
            
<li >
    <a href="../replication/">Replication</a>
</li>
            
<li >
    <a href="../couchdb-quirks/">CouchDB Quirks</a>
</li>
            
<li >
    <a href="../files/">/files - Virtual File System</a>
</li>
            
<li >
    <a href="../references-docs-in-vfs/">References of documents in VFS</a>
</li>
            
<li >
    <a href="../intents/">/intents - Intents</a>
</li>
            
<li >
    <a href="../jobs/">/jobs Jobs</a>
</li>
            
<li >
    <a href="../konnectors/">Konnectors</a>
</li>
            
<li >
    <a href="../workers/">Workers</a>
</li>
            
<li >
    <a href="../notifications/">/notifications - Notifications</a>
</li>
            
<li >
    <a href="../permissions/">/permissions - Permissions</a>
</li>
            
<li >
    <a href="../realtime/">/realtime - Realtime</a>
</li>
            
<li >
    <a href="../remote/">/remote - Proxy for remote data/API</a>
</li>
            
<li >
    <a href="../settings/">/settings - Settings</a>
</li>
            
<li class="active">
    <a href="./">/sharings - Sharing</a>
</li>
            
<li >
    <a href="../sharing-design/">Request for comments</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">konitor</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../konitor/cli/">CLI</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li>
                        <a href="https://github.com/cozy/cozy-docs-v3/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#sharing">Sharing</a></li>
            <li><a href="#sharing-by-links">Sharing by links</a></li>
            <li><a href="#cozy-to-cozy-sharing">Cozy to cozy sharing</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p><a href="../README/#table-of-contents">Table of contents</a></p>
<p>{% raw %}</p>
<h1 id="sharing">Sharing<a class="headerlink" href="#sharing" title="Permanent link">&para;</a></h1>
<p>The owner of a cozy instance can share access to her documents to other users.</p>
<h2 id="sharing-by-links">Sharing by links<a class="headerlink" href="#sharing-by-links" title="Permanent link">&para;</a></h2>
<p>A client-side application can propose sharing by links:</p>
<ol>
<li>The application must have a public route in its manifest. See
   <a href="../apps/#routes">Apps documentation</a> for how to do that.</li>
<li>The application can create a set of permissions for the shared documents,
   with codes. See <a href="../permissions/">permissions documentation</a> for the details.</li>
<li>The application can then create a shareable link (e.g.
   <code>https://calendar.cozy.example.net/public?sharecode=eiJ3iepoaihohz1Y</code>) by
   putting together the app sub-domain, the public route path, and a code for
   the permissions set.</li>
<li>The app can then send this link by mail, via the <a href="../jobs/">jobs system</a>, or
   just give it to the user, so he can transmit it to her friends via chat or
   other ways.</li>
</ol>
<p>When someone opens the shared link, the stack will load the public route, find
the corresponding <code>index.html</code> file, and replace <code>{{.Token}}</code> inside it by a
token with the same set of permissions that <code>sharecode</code> offers. This token can
then be used as a <code>Bearer</code> token in the <code>Authorization</code> header for requests to
the stack (or via cozy-client-js).</p>
<p>If necessary, the application can list the permissions for the token by calling
<code>/permissions/self</code> with this token.</p>
<h2 id="cozy-to-cozy-sharing">Cozy to cozy sharing<a class="headerlink" href="#cozy-to-cozy-sharing" title="Permanent link">&para;</a></h2>
<p>The owner of a cozy instance can send and synchronize documents to others cozy
users.</p>
<h3 id="routes">Routes<a class="headerlink" href="#routes" title="Permanent link">&para;</a></h3>
<h4 id="post-sharings">POST /sharings/<a class="headerlink" href="#post-sharings" title="Permanent link">&para;</a></h4>
<p>Create a new sharing. The sharing rules and recipients must be specified. The
<code>description</code>, <code>preview_path</code>, and <code>open_sharing</code> fields are optional. The
<code>app_slug</code> field is optional and is the slug of the web app by default.</p>
<h5 id="request">Request<a class="headerlink" href="#request" title="Permanent link">&para;</a></h5>
<pre class="codehilite"><code class="language-http">POST /sharings/ HTTP/1.1
Host: alice.example.net
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings&quot;,
    &quot;attributes&quot;: {
      &quot;description&quot;: &quot;sharing test&quot;,
      &quot;preview_path&quot;: &quot;/preview-sharing&quot;,
      &quot;rules&quot;: [
        {
          &quot;title&quot;: &quot;Hawaii&quot;,
          &quot;doctype&quot;: &quot;io.cozy.files&quot;,
          &quot;values&quot;: [&quot;612acf1c-1d72-11e8-b043-ef239d3074dd&quot;],
          &quot;add&quot;: &quot;sync&quot;,
          &quot;update&quot;: &quot;sync&quot;,
          &quot;remove&quot;: &quot;sync&quot;
        }
      ]
    },
    &quot;relationships&quot;: {
      &quot;recipients&quot;: {
        &quot;data&quot;: [
          {
            &quot;id&quot;: &quot;2a31ce0128b5f89e40fd90da3f014087&quot;,
            &quot;type&quot;: &quot;io.cozy.contacts&quot;
          }
        ]
      }
    }
  }
}</code></pre>


<h4 id="response">Response<a class="headerlink" href="#response" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings&quot;,
    &quot;id&quot;: &quot;ce8835a061d0ef68947afe69a0046722&quot;,
    &quot;meta&quot;: {
      &quot;rev&quot;: &quot;1-4859c6c755143adf0838d225c5e97882&quot;
    },
    &quot;attributes&quot;: {
      &quot;description&quot;: &quot;sharing test&quot;,
      &quot;preview_path&quot;: &quot;/preview-sharing&quot;,
      &quot;app_slug&quot;: &quot;drive&quot;,
      &quot;owner&quot;: true,
      &quot;created_at&quot;: &quot;2018-01-04T12:35:08Z&quot;,
      &quot;updated_at&quot;: &quot;2018-01-04T13:45:43Z&quot;,
      &quot;members&quot;: [
        {
          &quot;status&quot;: &quot;owner&quot;,
          &quot;name&quot;: &quot;Alice&quot;,
          &quot;email&quot;: &quot;alice@example.net&quot;,
          &quot;instance&quot;: &quot;alice.example.net&quot;
        },
        {
          &quot;status&quot;: &quot;mail-not-sent&quot;,
          &quot;name&quot;: &quot;Bob&quot;,
          &quot;email&quot;: &quot;bob@example.net&quot;
        }
      ],
      &quot;rules&quot;: [
        {
          &quot;title&quot;: &quot;Hawaii&quot;,
          &quot;doctype&quot;: &quot;io.cozy.files&quot;,
          &quot;values&quot;: [&quot;612acf1c-1d72-11e8-b043-ef239d3074dd&quot;],
          &quot;add&quot;: &quot;sync&quot;,
          &quot;update&quot;: &quot;sync&quot;,
          &quot;remove&quot;: &quot;sync&quot;
        }
      ]
    },
    &quot;links&quot;: {
      &quot;self&quot;: &quot;/sharings/ce8835a061d0ef68947afe69a0046722&quot;
    }
  }
}</code></pre>


<h3 id="get-sharingssharing-iddiscovery">GET /sharings/:sharing-id/discovery<a class="headerlink" href="#get-sharingssharing-iddiscovery" title="Permanent link">&para;</a></h3>
<p>If no preview_path is set, it&rsquo;s an URL to this route that will be sent to the
users to notify them that someone wants to share something with them. On this
page, they can fill the URL of their Cozy (if the user has already filled its
Cozy URL in a previous sharing, the form will be pre-filled and the user will
just have to click OK).</p>
<h4 id="query-string">Query-String<a class="headerlink" href="#query-string" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>state</td>
<td>a code that identify the recipient</td>
</tr>
</tbody>
</table>
<h4 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">GET /sharings/ce8835a061d0ef68947afe69a0046722/discovery?state=eiJ3iepoaihohz1Y HTTP/1.1
Host: alice.example.net</code></pre>


<h3 id="post-sharingssharing-iddiscovery">POST /sharings/:sharing-id/discovery<a class="headerlink" href="#post-sharingssharing-iddiscovery" title="Permanent link">&para;</a></h3>
<p>Give to the cozy of the sharer the URL of the Cozy of one recipient. The sharer
will register its-self as an OAuth client on the recipient cozy, and then will
ask the recipient to accept the permissions on its instance.</p>
<p>This route exists in two versions, the version is selected by the HTTP header
<code>Accept</code></p>
<h4 id="classical-x-www-url-encoded">Classical (<code>x-www-url-encoded</code>)<a class="headerlink" href="#classical-x-www-url-encoded" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>state</td>
<td>a code that identify the recipient</td>
</tr>
<tr>
<td>url</td>
<td>the URL of the Cozy for the recipient</td>
</tr>
</tbody>
</table>
<h5 id="example_1">Example<a class="headerlink" href="#example_1" title="Permanent link">&para;</a></h5>
<pre class="codehilite"><code class="language-http">POST /sharings/ce8835a061d0ef68947afe69a0046722/discovery HTTP/1.1
Host: alice.example.org
Content-Type: application/x-www-form-urlencoded
Accept: text/html

state=eiJ3iepoaihohz1Y&amp;url=https://bob.example.net/</code></pre>


<pre class="codehilite"><code class="language-http">HTTP/1.1 302 Moved Temporarily
Location: https://bob.example.net/auth/sharing?...</code></pre>


<h4 id="json">JSON<a class="headerlink" href="#json" title="Permanent link">&para;</a></h4>
<p>This version can be more convenient for applications that implement the
preview page. To do that, an application must give a <code>preview_path</code> when
creating the sharing. This path must be a public route of this application.
The recipients will receive a link to the application subdomain, on this page,
and with a <code>sharecode</code> in the query string (like for a share by link).</p>
<p>To know the <code>sharing-id</code>, it&rsquo;s possible to ask <code>GET /permissions/self</code>, with
the <code>sharecode</code> in the <code>Authorization</code> header (it&rsquo;s a JWT token). In the
response, the <code>source_id</code> field will be <code>io.cozy.sharings/&lt;sharing-id&gt;</code>.</p>
<h5 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sharecode</td>
<td>a code that identify the recipient</td>
</tr>
<tr>
<td>url</td>
<td>the URL of the Cozy for the recipient</td>
</tr>
</tbody>
</table>
<h5 id="example_2">Example<a class="headerlink" href="#example_2" title="Permanent link">&para;</a></h5>
<pre class="codehilite"><code class="language-http">POST /sharings/ce8835a061d0ef68947afe69a0046722/discovery HTTP/1.1
Host: alice.example.org
Content-Type: application/x-www-form-urlencoded
Accept: application/json

sharecode=eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJhcHAiLCJpYXQiOjE1MjAzNDM4NTc&amp;url=https://bob.example.net/</code></pre>


<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;redirect&quot;: &quot;https://bob.example.net/auth/sharing?...&quot;
}</code></pre>


<h3 id="get-sharingssharing-id">GET /sharings/:sharing-id<a class="headerlink" href="#get-sharingssharing-id" title="Permanent link">&para;</a></h3>
<p>Get the information about a sharing. This includes the content of the rules, the members, as well as the already shared documents for this sharing.</p>
<h4 id="request_1">Request<a class="headerlink" href="#request_1" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">GET /sharings/ce8835a061d0ef68947afe69a0046722 HTTP/1.1
Host: alice.example.net
Accept: application/vnd.api+json</code></pre>


<h4 id="response_1">Response<a class="headerlink" href="#response_1" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings&quot;,
    &quot;id&quot;: &quot;ce8835a061d0ef68947afe69a0046722&quot;,
    &quot;meta&quot;: {
      &quot;rev&quot;: &quot;1-4859c6c755143adf0838d225c5e97882&quot;
    },
    &quot;attributes&quot;: {
      &quot;description&quot;: &quot;sharing test&quot;,
      &quot;preview_path&quot;: &quot;/preview-sharing&quot;,
      &quot;app_slug&quot;: &quot;drive&quot;,
      &quot;owner&quot;: true,
      &quot;created_at&quot;: &quot;2018-01-04T12:35:08Z&quot;,
      &quot;updated_at&quot;: &quot;2018-01-04T13:45:43Z&quot;,
      &quot;members&quot;: [
        {
          &quot;status&quot;: &quot;owner&quot;,
          &quot;name&quot;: &quot;Alice&quot;,
          &quot;email&quot;: &quot;alice@example.net&quot;,
          &quot;instance&quot;: &quot;alice.example.net&quot;
        },
        {
          &quot;status&quot;: &quot;ready&quot;,
          &quot;name&quot;: &quot;Bob&quot;,
          &quot;email&quot;: &quot;bob@example.net&quot;
        }
      ],
      &quot;rules&quot;: [
        {
          &quot;title&quot;: &quot;Hawaii&quot;,
          &quot;doctype&quot;: &quot;io.cozy.files&quot;,
          &quot;values&quot;: [&quot;612acf1c-1d72-11e8-b043-ef239d3074dd&quot;],
          &quot;add&quot;: &quot;sync&quot;,
          &quot;update&quot;: &quot;sync&quot;,
          &quot;remove&quot;: &quot;sync&quot;
        }
      ],
    },
    &quot;relationships&quot;: {
      &quot;shared_docs&quot;: {
        &quot;data&quot;: [
          {
            &quot;id&quot;: &quot;612acf1c-1d72-11e8-b043-ef239d3074dd&quot;,
            &quot;type&quot;: &quot;io.cozy.files&quot;
          },
          {
            &quot;id&quot;: &quot;a34528d2-13fb-9482-8d20-bf1972531225&quot;,
            &quot;type&quot;: &quot;io.cozy.files&quot;
          }
        ]
      }
    },
    &quot;links&quot;: {
      &quot;self&quot;: &quot;/sharings/ce8835a061d0ef68947afe69a0046722&quot;
    }
  }
}</code></pre>


<h3 id="put-sharingssharing-id">PUT /sharings/:sharing-id<a class="headerlink" href="#put-sharingssharing-id" title="Permanent link">&para;</a></h3>
<p>The sharer&rsquo;s cozy sends a request to this route on the recipient&rsquo;s cozy to
create a sharing request, with most of the informations about the sharing.
These informations will be displayed to the recipient just before its final
acceptation of the sharing, to be sure he/she knows what will be shared.</p>
<h4 id="request_2">Request<a class="headerlink" href="#request_2" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">PUT /sharings/ce8835a061d0ef68947afe69a0046722 HTTP/1.1
Host: bob.example.net
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings&quot;,
    &quot;id&quot;: &quot;ce8835a061d0ef68947afe69a0046722&quot;,
    &quot;attributes&quot;: {
      &quot;description&quot;: &quot;sharing test&quot;,
      &quot;preview_path&quot;: &quot;/preview-sharing&quot;,
      &quot;app_slug&quot;: &quot;drive&quot;,
      &quot;owner&quot;: true,
      &quot;created_at&quot;: &quot;2018-01-04T12:35:08Z&quot;,
      &quot;updated_at&quot;: &quot;2018-01-04T13:45:43Z&quot;,
      &quot;members&quot;: [
        {
          &quot;status&quot;: &quot;owner&quot;,
          &quot;name&quot;: &quot;Alice&quot;,
          &quot;email&quot;: &quot;alice@example.net&quot;,
          &quot;instance&quot;: &quot;alice.example.net&quot;
        },
        {
          &quot;status&quot;: &quot;mail-not-sent&quot;,
          &quot;name&quot;: &quot;Bob&quot;,
          &quot;email&quot;: &quot;bob@example.net&quot;,
          &quot;instance&quot;: &quot;bob.example.net&quot;
        }
      ],
      &quot;rules&quot;: [
        {
          &quot;title&quot;: &quot;Hawaii&quot;,
          &quot;doctype&quot;: &quot;io.cozy.files&quot;,
          &quot;values&quot;: [&quot;612acf1c-1d72-11e8-b043-ef239d3074dd&quot;],
          &quot;add&quot;: &quot;sync&quot;,
          &quot;update&quot;: &quot;sync&quot;,
          &quot;remove&quot;: &quot;sync&quot;
        }
      ]
    }
  }
}</code></pre>


<h4 id="response_2">Response<a class="headerlink" href="#response_2" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings&quot;,
    &quot;id&quot;: &quot;ce8835a061d0ef68947afe69a0046722&quot;,
    &quot;meta&quot;: {
      &quot;rev&quot;: &quot;1-f579a69a9fa5dd720010a1dbb82320be&quot;
    },
    &quot;attributes&quot;: {
      &quot;description&quot;: &quot;sharing test&quot;,
      &quot;preview_path&quot;: &quot;/preview-sharing&quot;,
      &quot;app_slug&quot;: &quot;drive&quot;,
      &quot;owner&quot;: true,
      &quot;created_at&quot;: &quot;2018-01-04T12:35:08Z&quot;,
      &quot;updated_at&quot;: &quot;2018-01-04T13:45:43Z&quot;,
      &quot;members&quot;: [
        {
          &quot;status&quot;: &quot;owner&quot;,
          &quot;name&quot;: &quot;Alice&quot;,
          &quot;email&quot;: &quot;alice@example.net&quot;,
          &quot;instance&quot;: &quot;alice.example.net&quot;
        },
        {
          &quot;status&quot;: &quot;mail-not-sent&quot;,
          &quot;name&quot;: &quot;Bob&quot;,
          &quot;email&quot;: &quot;bob@example.net&quot;,
          &quot;instance&quot;: &quot;bob.example.net&quot;
        }
      ],
      &quot;rules&quot;: [
        {
          &quot;title&quot;: &quot;Hawaii&quot;,
          &quot;doctype&quot;: &quot;io.cozy.files&quot;,
          &quot;values&quot;: [&quot;612acf1c-1d72-11e8-b043-ef239d3074dd&quot;],
          &quot;add&quot;: &quot;sync&quot;,
          &quot;update&quot;: &quot;sync&quot;,
          &quot;remove&quot;: &quot;sync&quot;
        }
      ]
    },
    &quot;links&quot;: {
      &quot;self&quot;: &quot;/sharings/ce8835a061d0ef68947afe69a0046722&quot;
    }
  }
}</code></pre>


<h3 id="post-sharingssharing-idanswer">POST /sharings/:sharing-id/answer<a class="headerlink" href="#post-sharingssharing-idanswer" title="Permanent link">&para;</a></h3>
<p>This route is used by the Cozy of a recipient to exchange credentials with the
Cozy of the sharer, after the recipient has accepted a sharing.</p>
<h4 id="request_3">Request<a class="headerlink" href="#request_3" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">POST /sharings/ce8835a061d0ef68947afe69a0046722/answer HTTP/1.1
Host: alice.example.net
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings.answer&quot;,
    &quot;id&quot;: &quot;ce8835a061d0ef68947afe69a0046722&quot;,
    &quot;attributes&quot;: {
      &quot;state&quot;: &quot;eiJ3iepoaihohz1Y&quot;,
      &quot;client&quot;: {...},
      &quot;access_token&quot;: &quot;uia7b85928e5cf&quot;
    }
  }
}</code></pre>


<h4 id="response_3">Response<a class="headerlink" href="#response_3" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/vnd.api+json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;type&quot;: &quot;io.cozy.sharings.answer&quot;,
    &quot;id&quot;: &quot;ce8835a061d0ef68947afe69a0046722&quot;,
    &quot;attributes&quot;: {
      &quot;client&quot;: {...},
      &quot;access_token&quot;: &quot;ui77bd4670fbd3&quot;
    }
  }
}</code></pre>


<h3 id="post-sharingssharing-id95revs_diff">POST /sharings/:sharing-id/_revs_diff<a class="headerlink" href="#post-sharingssharing-id95revs_diff" title="Permanent link">&para;</a></h3>
<p>This endpoint is used by the sharing replicator of the stack to know which
documents must be sent to the other cozy. It is inspired by
http://docs.couchdb.org/en/2.1.1/api/database/misc.html#db-revs-diff.</p>
<h4 id="request_4">Request<a class="headerlink" href="#request_4" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">POST /sharings/ce8835a061d0ef68947afe69a0046722/_revs_diff HTTP/1.1
Host: bob.example.net
Accept: application/json
Content-Type: application/json
Authorization: Bearer ...</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;io.cozy.files/29631902-2cec-11e8-860d-435b24c2cc58&quot;: [
    &quot;2-4a7e4ae49c4366eaed8edeaea8f784ad&quot;
  ],
  &quot;io.cozy.files/44f5752a-2cec-11e8-b227-abfc3cfd4b6e&quot;: [
    &quot;4-2ee767305024673cfb3f5af037cd2729&quot;,
    &quot;4-efc54218773c6acd910e2e97fea2a608&quot;
  ]
}</code></pre>


<h4 id="response_4">Response<a class="headerlink" href="#response_4" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/json</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;io.cozy.files/44f5752a-2cec-11e8-b227-abfc3cfd4b6e&quot;: {
    &quot;missing&quot;: [
      &quot;4-2ee767305024673cfb3f5af037cd2729&quot;
    ],
    &quot;possible_ancestors&quot;: [
      &quot;3-753875d51501a6b1883a9d62b4d33f91&quot;
    ]
  }
}</code></pre>


<h3 id="post-sharingssharing-id95bulk_docs">POST /sharings/:sharing-id/_bulk_docs<a class="headerlink" href="#post-sharingssharing-id95bulk_docs" title="Permanent link">&para;</a></h3>
<p>This endpoint is used by the sharing replicator of the stack to send
documents in a bulk to the other cozy. It is inspired by
http://docs.couchdb.org/en/2.1.1/api/database/bulk-api.html#db-bulk-docs.</p>
<p><strong>Note</strong>: we force <code>new_edits</code> to <code>false</code>.</p>
<h4 id="request_5">Request<a class="headerlink" href="#request_5" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">POST /sharings/ce8835a061d0ef68947afe69a0046722/_bulk_docs HTTP/1.1
Host: bob.example.net
Accept: application/json
Content-Type: application/json
Authorization: Bearer ...</code></pre>


<pre class="codehilite"><code class="language-json">{
  &quot;io.cozy.files&quot;: [{
    &quot;_id&quot;: &quot;44f5752a-2cec-11e8-b227-abfc3cfd4b6e&quot;,
    &quot;_rev&quot;: &quot;4-2ee767305024673cfb3f5af037cd2729&quot;,
    &quot;_revisions&quot;: {
      &quot;start&quot;: 4,
      &quot;ids&quot;: [
        &quot;2ee767305024673cfb3f5af037cd2729&quot;,
        &quot;753875d51501a6b1883a9d62b4d33f91&quot;,
      ]
    }
  }]
}</code></pre>


<h4 id="response_5">Response<a class="headerlink" href="#response_5" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-http">HTTP/1.1 200 OK
Content-Type: application/json</code></pre>


<pre class="codehilite"><code class="language-json">[]</code></pre>


<p>{% endraw %}</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <!-- Piwik -->
        <script type="text/javascript">
          var _paq = _paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
            var u="//piwik.cozycloud.cc/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', '7']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
          })();
        </script>
        <noscript><p><img src="//piwik.cozycloud.cc/piwik.php?idsite=7&rec=1" style="border:0;" alt="" /></p></noscript>
        <!-- End Piwik Code -->
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../extra.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
